schema: moran_aux
source_dir: ../dist
script: |
  function eq(left, right)
    print('Left  = ' .. tostring(left))
    print('Right = ' .. tostring(right))
    return left == right
  end

deploy:
  default:
    tests:
      - send: 'lmjxz'
        assert: cand[1].text == 'é€£æ¥' and cand[1].comment == 'z'
      - send: 'iifjku'
        assert: cand[2].text == 'å–«é£¯'
      - send: 'iifjuk'
        assert: cand[2].text == 'å–«é£¯'
      - send: 'jivm'
        assert: cand[3].comment ~= 'vm'

  aux_hint:
    patch:
      moran/enable_aux_hint: true
    tests:
      - send: 'keyima'
        assert: eq(cand[1].text, 'å¯ä»¥å—')

  tab:
    tests:
      - send: 'lmjx{Tab}j{space}{space}'
        assert: commit == 'éˆæ¥'

  pin:
    tests:
      - send: 'lmjx'
        assert: cand[1].text == 'éˆæ¥' and cand[2].text == 'é€£æ¥'
      - send: 'lmjx{Control+t}'  # SIDE-EFFECT!!
        assert: cand[1].comment == "ğŸ“Œ"
      - send: 'lmjx{Control+t}'
        assert: cand[1].comment == ""
      - send: 'lmjx{Down}{Control+t}'
        assert: cand[1].text == 'é€£æ¥' and cand[1].comment == "ğŸ“Œ"
      - send: 'lmjx'
        assert: cand[1].text == 'é€£æ¥' and cand[1].comment == "ğŸ“Œ"

# yaml-language-server: $schema=https://raw.githubusercontent.com/rimeinn/mira/refs/heads/master/spec/mira.schema.json
